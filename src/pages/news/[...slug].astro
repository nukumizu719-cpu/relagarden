---
import BaseLayout from '../../layouts/BaseLayout.astro';
import { getCollection } from 'astro:content';
import { Image } from 'astro:assets';

export async function getStaticPaths() {
  const newsEntries = await getCollection('news');
  return newsEntries.map(entry => ({
    params: { slug: entry.slug },
    props: { entry },
  }));
}

const { entry } = Astro.props;
const { Content } = await entry.render();

const formattedDate = entry.data.pubDate.toLocaleDateString('ja-JP').replace(/\//g, '.');
---

<BaseLayout exactTitle={entry.data.title} description={entry.data.description}>
  <article class="bg-white min-h-screen">
    <header class="pt-20 pb-16 md:pt-32 md:pb-24 border-b border-gray-50 bg-[#fdfdfb]">
      <div class="max-w-4xl mx-auto px-6 text-center">
        <div class="flex items-center justify-center gap-3 mb-8">
          <time class="text-sm font-sans tracking-widest text-gray-400 font-bold">{formattedDate}</time>
          <span class="bg-green-700 text-white text-[10px] font-bold px-3 py-1 rounded-sm shadow-sm tracking-[0.1em] uppercase">
            {entry.data.category}
          </span>
        </div>
        <h1 class="text-3xl md:text-5xl font-bold font-zen text-gray-900 leading-[1.4] mb-8">{entry.data.title}</h1>
        {entry.data.description && (
          <p class="text-gray-500 text-base md:text-lg font-zen leading-relaxed max-w-2xl mx-auto">{entry.data.description}</p>
        )}
      </div>
    </header>

    <div class="max-w-3xl mx-auto px-6 py-16 md:py-24">
      {entry.data.heroImage && (
        <div class="mb-16 -mx-4 md:-mx-12">
          <Image src={entry.data.heroImage} alt={entry.data.title} width={1200} height={675} class="rounded-2xl shadow-2xl w-full h-auto object-cover" />
        </div>
      )}

      <div class="prose prose-lg prose-flat max-w-none font-zen text-gray-800 leading-[2.1]
        prose-h2:text-2xl prose-h2:font-bold prose-h2:text-gray-900 prose-h2:border-b-2 prose-h2:border-green-700 prose-h2:pb-4 prose-h2:mt-20 prose-h2:mb-10
        prose-h3:text-xl prose-h3:font-bold prose-h3:text-green-800 prose-h3:mt-12 prose-h3:mb-6 prose-h3:flex prose-h3:items-center prose-h3:before:content-[''] prose-h3:before:w-1.5 prose-h3:before:h-6 prose-h3:before:bg-green-700 prose-h3:before:mr-3 prose-h3:before:rounded-full
        prose-p:mb-8 prose-p:text-[17px]
        prose-strong:text-green-900 prose-strong:bg-green-50 prose-strong:px-1
        prose-img:rounded-3xl prose-img:shadow-xl prose-img:my-14
        prose-ul:bg-gray-50 prose-ul:p-8 prose-ul:rounded-2xl prose-ul:my-10">
        <Content />
      </div>

      <footer class="mt-24 pt-16 border-t border-gray-100 flex justify-center">
        <a href="/news/" class="group flex items-center gap-4 text-sm font-bold font-zen text-gray-500 hover:text-green-700 transition-all">
          <span class="w-12 h-12 rounded-full border border-gray-200 flex items-center justify-center group-hover:border-green-700 group-hover:bg-green-700 group-hover:text-white transition-all duration-300">&larr;</span>
          ニュース一覧へ戻る
        </a>
      </footer>
    </div>
  </article>
</BaseLayout>

<style is:global>
  .prose a { color: #15803d; text-decoration: none; font-weight: bold; border-bottom: 2px solid transparent; transition: border-color 0.3s; }
  .prose a:hover { border-color: #15803d; }
  .prose blockquote { border-left: none; background: #f8fafc; padding: 2.5rem 2rem; border-radius: 1.5rem; color: #334155; position: relative; }
  .prose blockquote::before { content: '“'; position: absolute; top: 10px; left: 20px; font-size: 5rem; color: #cbd5e1; font-family: serif; line-height: 1; opacity: 0.5; }
</style>